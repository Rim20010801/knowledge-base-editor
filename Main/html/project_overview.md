# ナレッジベースシステム 概要

## はじめに

ナレッジベースシステムは、記事の作成、編集、検索、保存を行うためのオフライン対応Webアプリケーションです。ユーザーは様々なコンテンツブロックを使って記事を構築し、IndexedDBに保存することができます。また、JSONファイルとしてエクスポート/インポートすることで、バックアップや他のデバイスとの同期が可能です。

## システム構成

システムは以下の主要コンポーネントで構成されています：

### 1. HTMLページ

- **index.html** - 記事一覧ページ（メインページ）
- **article.html** - 記事表示ページ
- **editor.html** - 記事編集ページ

### 2. JavaScriptモジュール

#### コアモジュール
- **schema.js** - データ構造の定義
- **database.js** - IndexedDBデータベース操作
- **converter.js** - 記事データとHTML間の変換
- **api.js** - 統合API（各モジュールへのインターフェース）

#### 検索関連
- **search.js** - 検索機能
- **indexer.js** - 検索インデックス構築

#### ユーティリティ
- **jsonHelper.js** - JSON操作のヘルパー関数
- **storage.js** - JSONファイル同期
- **sharedStatus.js** - 共有ステータス管理
- **debounce.js** - イベント最適化

#### UIモジュール
- **editor.js** - エディタのUI操作

### 3. データフロー

![データフロー図](../img/data-flow.png)

1. ユーザーがUI経由でデータを操作
2. API層がリクエストを適切なモジュールに転送
3. データ操作はデータベース層で処理
4. 変更はUIに反映、必要に応じてストレージに永続化

## 主要機能

### 1. 記事管理

- 新規記事の作成
- 既存記事の表示と編集
- 記事の削除
- 記事の検索（タイトル・全文）

### 2. ブロックベースエディタ

記事は以下のようなブロックで構成されます：

- 見出し (Heading)
- 段落 (Paragraph)
- リスト (List) - 順序付き/順序なし
- 画像 (Image)
- コード (Code)

ブロックベースのエディタにより、コンテンツの構造化と柔軟な編集が可能です。

### 3. 検索機能

- タイトル検索
- 全文検索
- リアルタイム検索結果表示（デバウンス処理）

### 4. データの永続化

- IndexedDBによるブラウザ内ストレージ
- JSONファイルのエクスポート/インポート
- 編集中のロック機能による同時編集防止

## 技術スタック

- **フロントエンド**: 純粋なJavaScript (バニラJS)
- **データ保存**: IndexedDB (ブラウザ内ストレージ)
- **UI**: HTML5, CSS3
- **エディタ**: カスタムブロックエディタ

## システムの拡張性

システムは以下の方針で拡張可能に設計されています：

1. **モジュール化** - 各機能は独立したモジュールとして実装
2. **APIレイヤー** - 統一されたAPIによる内部モジュールの抽象化
3. **プラグイン構造** - 新機能を既存コードを変更せずに追加可能
4. **イベントベース通信** - モジュール間の疎結合な通信

## 使用方法

### 記事の作成

1. トップページ（index.html）の「新規作成」ボタンをクリック
2. タイトル、カテゴリ、タグを入力
3. 「ブロックを追加」ボタンでコンテンツブロックを追加
4. ブロックの編集ボタンでコンテンツを編集
5. 「保存」ボタンで記事を保存

### 記事の編集

1. 記事一覧または記事表示ページから「編集」ボタンをクリック
2. 記事データが編集フォームに読み込まれる
3. コンテンツを編集
4. 「保存」ボタンで変更を保存

### 記事のエクスポート/インポート

1. トップページの「インポート/エクスポート」ボタンをクリック
2. 「全記事エクスポート」で全記事をJSONファイルとして保存
3. 「ファイルを選択」でJSONファイルを選択し、「インポート」で記事をインポート

## 制限事項

- オフライン専用のアプリケーションであり、オンライン同期機能はない
- 画像はBase64エンコードで保存されるため、大量の画像の使用はパフォーマンスに影響する可能性がある
- 大量の記事や大きな記事はブラウザのストレージ制限に達する可能性がある

## 将来の拡張計画

- サーバー側との同期機能
- 複数デバイス間のリアルタイム編集
- タグベースのナビゲーション強化
- 高度な全文検索機能
- テンプレート機能
- マークダウンインポート/エクスポート 