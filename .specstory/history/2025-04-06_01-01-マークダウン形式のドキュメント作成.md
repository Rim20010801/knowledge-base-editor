<!-- Generated by SpecStory -->

# マークダウン形式のドキュメント作成 (2025-04-06 10:01:49)

_**User**_

ドキュメントをmd形式で作成し、出力して。

---

_**Assistant**_

おはよう！ナレッジベースのドキュメントをマークダウン形式で作成するね。article.htmlファイルを分析して、そのドキュメントを作成するよ。

---

<details>
            <summary>Searched codebase "関連するmdファイルやドキュメント" • **23** results</summary>
        
| File | Lines |
|------|-------|
| `Main/doc/README.md` | L1-56 |
| `doc/README.md` | L1-56 |
| `.specstory/history/2025-04-05_09-02-使用ドキュメントの作成とコード解説.md` | L5180-5521 |
| `archive/old_config/.specstory/history/2025-03-20_10-54-ナビバーのデザイン調整.md` | L4045-4116 |
| `doc/api.js_documentation.md` | L389-465 |
| `Main/doc/api.js_documentation.md` | L389-465 |
| `.specstory/history/2025-04-05_09-02-使用ドキュメントの作成とコード解説.md` | L5521-5713 |
| `archive/old_config/.specstory/history/2025-03-20_02-37-進捗確認とコア機能の状況.md` | L627-751 |
| `archive/old_config/docs/development/project-structure.md` | L1-61 |
| `archive/old_config/.specstory/history/2025-03-15_07-59-知識管理システムの全体構造設計.md` | L31424-31466 |
| `archive/old_docs/main-documentation.md` | L277-303 |
| `archive/old_docs/knowledge-database-summary (1).md` | L35-101 |
| `archive/old_config/docs/README.md` | L659-737 |
| `archive/old_config/.specstory/history/2025-03-20_10-54-ナビバーのデザイン調整.md` | L3806-3898 |
| `archive/old_config/.specstory/history/2025-03-18_20-10-構造分析と次のステップ提案.md` | L10256-10525 |
| `.specstory/history/2025-04-05_09-02-使用ドキュメントの作成とコード解説.md` | L4387-4432 |
| `archive/old_files/backup/knowledge_system_files.md` | L1-38 |
| `archive/old_files/backup/knowledge-database-summary.md` | L35-101 |
| `archive/old_config/.specstory/history/2025-03-15_07-59-知識管理システムの全体構造設計.md` | L34391-34412 |
| `archive/old_files/samples/documents/document_6.json` | L1-11 |
| `archive/old_docs/site-flowchart.md` | L156-180 |
| `archive/old_config/.specstory/history/2025-03-15_07-59-知識管理システムの全体構造設計.md` | L31466-31513 |
| `archive/old_files/samples/documents/document_18.json` | L1-11 |

</details>

---

<details>
            <summary>Listed directory Main/doc • **12** results</summary>
        
| Name |
|-------|
| 📄 `editor.js_documentation.md` |
| 📄 `database.js_documentation.md` |
| 📄 `converter.js_documentation.md` |
| 📄 `storage.js_documentation.md` |
| 📄 `search.js_documentation.md` |
| 📄 `sharedStatus.js_documentation.md` |
| 📄 `schema.js_documentation.md` |
| 📄 `jsonHelper.js_documentation.md` |
| 📄 `indexer.js_documentation.md` |
| 📄 `debounce.js_documentation.md` |
| 📄 `api.js_documentation.md` |
| 📄 `README.md` |

</details>

---

Read file: Main/article.html

---

```diff
- 
+ # 記事表示ページ（article.html）
+ 
+ ## 概要
+ 
+ 記事表示ページは、ナレッジベースシステムの個別記事を閲覧するためのインターフェースです。このページでは記事の内容を読みやすく表示し、編集や削除などの基本操作が可能です。
+ 
+ ## ファイル構造
+ 
+ `article.html`ファイルは、以下のような構成で作られています：
+ 
+ - HTML基本構造（DOCTYPE宣言、head、bodyなど）
+ - CSS（インラインスタイル）
+ - 必要なJavaScriptライブラリの読み込み
+ - ページ構造（ヘッダー、コンテンツエリア、アクションボタン）
+ - メインスクリプト（記事の取得と表示、イベント処理）
+ 
+ ## 主要コンポーネント
+ 
+ ### 1. ヘッダー部分
+ 
+ ```html
+ <header>
+     <div class="header-container">
+         <h1 class="site-title">ナレッジベース</h1>
+         <nav class="main-nav">
+             <ul>
+                 <li><a href="index.html">記事一覧</a></li>
+             </ul>
+         </nav>
+     </div>
+ </header>
+ ```
+ 
+ サイトのタイトルとナビゲーションメニューを表示します。現在は記事一覧へのリンクのみが実装されています。
+ 
+ ### 2. アクションボタン
+ 
+ ```html
+ <!-- 上部アクション領域 -->
+ <div class="article-actions top-actions">
+     <button id="back-to-list-btn" class="btn" onclick="window.location.href='index.html'">一覧に戻る</button>
+     <button id="edit-article-btn" class="btn">編集</button>
+ </div>
+ 
+ <!-- 下部アクション領域 -->
+ <div class="article-actions bottom-actions">
+     <button id="delete-article-btn" class="btn btn-secondary">記事を削除</button>
+ </div>
+ ```
+ 
+ 記事に対する操作ボタンが配置されています：
+ - 上部：記事一覧に戻るボタンと編集ボタン
+ - 下部：記事削除ボタン
+ 
+ ### 3. 記事表示領域
+ 
+ ```html
+ <main>
+     <div id="article-view" class="article-view">
+         <div class="loading-indicator">記事を読み込み中...</div>
+     </div>
+ </main>
+ ```
+ 
+ 記事の内容が表示される領域です。初期状態では「記事を読み込み中...」というメッセージが表示されます。
+ 
+ ## JavaScript機能
+ 
+ ### 1. 初期化と記事読み込み
+ 
+ ```javascript
+ document.addEventListener('DOMContentLoaded', async () => {
+     // URLパラメータから記事IDを取得
+     const urlParams = new URLSearchParams(window.location.search);
+     const articleId = urlParams.get('id');
+     
+     // 記事IDがない場合のエラーハンドリング
+     if (!articleId) {
+         document.getElementById('article-view').innerHTML = 
+             '<div class="error-message">記事IDが指定されていません。<a href="index.html">一覧に戻る</a></div>';
+         return;
+     }
+     
+     // KBシステムの初期化と記事の取得
+     try {
+         const initialized = await KB.initialize();
+         const article = await KB.articles.get(articleId);
+         
+         // 記事表示処理...
+     } catch (error) {
+         // エラーハンドリング...
+     }
+ });
+ ```
+ 
+ ページロード時にURLから記事IDを取得し、データベースから該当記事を読み込みます。
+ 
+ ### 2. 記事表示処理
+ 
+ ```javascript
+ function displayArticle(articleData) {
+     // 記事を表示する要素を取得
+     const articleView = document.getElementById('article-view');
+     
+     // ローディング表示を削除
+     articleView.innerHTML = '';
+     
+     // 記事データをHTMLに変換
+     const articleHtml = Converter.articleToHtml(articleData);
+     
+     // 変換されたHTMLを表示領域に挿入
+     articleView.innerHTML = articleHtml;
+ }
+ ```
+ 
+ `Converter.articleToHtml`関数を使用して記事データをHTML形式に変換し、表示します。
+ 
+ ### 3. イベントリスナー設定
+ 
+ ```javascript
+ // 編集ボタンのクリックイベント
+ document.getElementById('edit-article-btn').addEventListener('click', () => {
+     window.location.href = `editor.html?id=${articleId}`;
+ });
+ 
+ // 削除ボタンのクリックイベント
+ document.getElementById('delete-article-btn').addEventListener('click', async () => {
+     if (confirm('記事を削除してもよろしいですか？')) {
+         try {
+             await KB.articles.delete(articleId);
+             alert('記事を削除しました');
+             window.location.href = 'index.html';
+         } catch (error) {
+             alert(`削除エラー: ${error.message || '不明なエラー'}`);
+         }
+     }
+ });
+ ```
+ 
+ - 編集ボタン：エディタページに遷移
+ - 削除ボタン：確認ダイアログ表示後、記事を削除
+ 
+ ## エラーハンドリング
+ 
+ ページは以下のエラー状況に対応しています：
+ 
+ 1. **記事IDがない場合**：「記事IDが指定されていません」というメッセージを表示
+ 2. **記事が見つからない場合**：「記事が見つかりませんでした」というメッセージを表示
+ 3. **削除エラー**：エラーメッセージをアラートで表示
+ 4. **一般的なエラー**：エラーメッセージを画面に表示し、コンソールにも詳細情報を出力
+ 
+ ## 依存関係
+ 
+ このページは以下のモジュールに依存しています：
+ 
+ 1. **schema.js** - データ構造の定義
+ 2. **database.js** - IndexedDBデータベース操作
+ 3. **converter.js** - 記事データをHTML形式に変換
+ 4. **jsonHelper.js** - JSON操作のヘルパー関数
+ 5. **sharedStatus.js** - 共有状態管理
+ 6. **api.js** - KB名前空間内のAPI関数
+ 
+ ## 使用例と拡張ポイント
+ 
+ ### 使用シナリオ
+ 
+ 1. ユーザーが記事一覧ページから記事をクリック（`article.html?id=123`のようなURLで遷移）
+ 2. 記事表示ページが開き、指定された記事が表示される
+ 3. ユーザーは記事を閲覧、編集、または削除が可能
+ 
+ ### 拡張の可能性
+ 
+ 1. **印刷機能** - 記事を印刷用にフォーマットするボタンの追加
+ 2. **共有機能** - 記事の共有リンクを生成するボタンの追加
+ 3. **関連記事表示** - 同じタグやカテゴリの記事へのリンクを表示
+ 4. **履歴表示** - 記事の編集履歴を閲覧する機能の追加
+ 5. **コメント機能** - 記事へのコメント追加と表示機能 
```

---

<details>
            <summary>Searched codebase "editor.htmlファイルの内容" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `editor.html` | L49-108 |
| `Main/editor.html` | L380-402 |
| `editor.html` | L1-49 |
| `Main/editor.html` | L1-75 |
| `Main/editor.html` | L303-342 |
| `Main/editor.html` | L271-303 |
| `Main/editor.html` | L154-219 |
| `archive/old_files/src/components/editor/component-editor.js` | L45-68 |
| `article-editor/index.html` | L25-58 |
| `article-editor/index.html` | L1-25 |
| `archive/old_files/backup/src_old/examples/block-article-editor-demo.html` | L144-175 |
| `Main/index.html` | L325-366 |
| `Main/test-converter.html` | L1-89 |
| `archive/old_docs/editor copy.html` | L1766-1799 |
| `archive/old_files/src/assets/js/modules/articles/article-editor.js` | L1162-1186 |
| `archive/old_docs/editor.html` | L935-1002 |
| `archive/old_docs/editor copy.html` | L981-1027 |
| `article-editor/js/editor.js` | L1-57 |
| `archive/old_docs/editor copy 3.html` | L1260-1294 |
| `archive/old_files/src/components/snippet/snippet-editor.js` | L55-111 |
| `archive/old_docs/editor.html` | L1683-1713 |
| `archive/old_files/src/components/editor/component-editor.js` | L146-159 |
| `archive/old_docs/editor.html` | L1965-1997 |
| `Main/editor.html` | L219-271 |
| `article-editor/index.html` | L58-113 |

</details>

---

Read file: Main/editor.html

---

Read file: Main/editor.html

---

```diff
- 
+ # 記事編集ページ（editor.html）
+ 
+ ## 概要
+ 
+ 記事編集ページは、ナレッジベースシステムで新規記事の作成や既存記事の編集を行うためのインターフェースです。ブロックベースのエディタを採用しており、様々な種類のコンテンツブロックを追加・編集できます。
+ 
+ ## ファイル構造
+ 
+ `editor.html`ファイルは、以下のような構成で作られています：
+ 
+ - HTML基本構造（DOCTYPE宣言、head、bodyなど）
+ - CSS（インラインスタイル）
+ - 必要なJavaScriptライブラリの読み込み
+ - ページ構造（ヘッダー、記事情報入力フォーム、ブロックリスト、アクションボタン）
+ - モーダルダイアログ（ブロック編集、プレビュー）
+ - メインスクリプト（初期化、イベントリスナー）
+ 
+ ## 主要コンポーネント
+ 
+ ### 1. ヘッダー部分
+ 
+ ```html
+ <header>
+     <div class="header-container">
+         <h1 class="site-title" id="editor-title">記事作成</h1>
+         <nav class="editor-nav">
+             <a href="index.html">トップに戻る</a>
+         </nav>
+     </div>
+ </header>
+ ```
+ 
+ サイトのタイトル（新規作成時は「記事作成」、編集時は「記事編集」）とナビゲーションリンクを表示します。
+ 
+ ### 2. 記事情報セクション
+ 
+ ```html
+ <section class="article-info">
+     <div class="form-group">
+         <label for="article-title">タイトル:</label>
+         <input type="text" id="article-title" placeholder="記事のタイトルを入力">
+     </div>
+     <div class="form-group">
+         <label for="article-category">カテゴリ:</label>
+         <input type="text" id="article-category" placeholder="カテゴリを入力">
+     </div>
+     <div class="form-group">
+         <label for="article-tags">タグ:</label>
+         <input type="text" id="article-tags" placeholder="カンマ区切りでタグを入力">
+     </div>
+ </section>
+ ```
+ 
+ 記事のメタデータ（タイトル、カテゴリ、タグ）を入力するフォームです。
+ 
+ ### 3. コンテンツブロックセクション
+ 
+ ```html
+ <section class="content-blocks">
+     <h2>コンテンツブロック</h2>
+     <div id="blocks-list" class="blocks-container article-list">
+         <!-- ブロックリストがここに表示されます -->
+     </div>
+     <button id="add-block" class="btn btn-add">ブロックを追加</button>
+ </section>
+ ```
+ 
+ 記事の本文を構成するブロックの一覧と、新しいブロックを追加するボタンが表示されます。ブロックリストは動的に生成されます。
+ 
+ ### 4. アクションボタン
+ 
+ ```html
+ <section class="action-buttons">
+     <button id="save-article" class="btn btn-save">保存</button>
+     <button id="preview-article" class="btn btn-preview">プレビュー</button>
+     <button id="export-article" class="btn btn-export">エクスポート</button>
+     <button id="cancel-editing" class="btn btn-cancel">キャンセル</button>
+ </section>
+ ```
+ 
+ 記事全体に対する操作ボタンが配置されています：
+ - 保存：記事をデータベースに保存
+ - プレビュー：記事のHTMLプレビューを表示
+ - エクスポート：記事をJSONファイルとしてエクスポート
+ - キャンセル：編集をキャンセルして一覧に戻る
+ 
+ ### 5. モーダルダイアログ
+ 
+ ```html
+ <!-- エディタモーダル -->
+ <div id="editor-modal" class="modal">
+     <div class="modal-content">
+         <span class="modal-close">&times;</span>
+         <h2>ブロック編集</h2>
+         <div id="modal-form" class="modal-form">
+             <!-- フォームがここに動的に挿入されます -->
+         </div>
+         <button id="save-block" class="btn btn-save">保存</button>
+     </div>
+ </div>
+ 
+ <!-- プレビューモーダル -->
+ <div id="preview-modal" class="modal">
+     <div class="modal-content">
+         <span class="modal-close">&times;</span>
+         <h2>プレビュー</h2>
+         <div id="preview-content" class="preview-content article-view">
+             <!-- プレビュー内容がここに表示されます -->
+         </div>
+     </div>
+ </div>
+ ```
+ 
+ 2つのモーダルダイアログが定義されています：
+ - ブロック編集モーダル：個々のブロックを編集するためのフォームを表示
+ - プレビューモーダル：記事のHTMLプレビューを表示
+ 
+ ## JavaScript機能
+ 
+ ### 1. 初期化と記事読み込み
+ 
+ ```javascript
+ document.addEventListener('DOMContentLoaded', async () => {
+     // URLから記事IDを取得
+     const urlParams = new URLSearchParams(window.location.search);
+     const articleId = urlParams.get('id');
+     
+     try {
+         // KBシステム初期化
+         const initialized = await KB.initialize();
+         
+         // 編集モード設定
+         if (articleId) {
+             // 既存記事の編集
+             document.getElementById('editor-title').textContent = '記事編集';
+             const article = await KB.articles.edit(articleId);
+             if (article) {
+                 KB.editor.setupEditor(article);
+             }
+         } else {
+             // 新規作成
+             const article = KB.articles.create();
+             KB.editor.setupEditor(article);
+         }
+         
+         // イベントリスナー設定...
+     } catch (error) {
+         // エラーハンドリング...
+     }
+ });
+ ```
+ 
+ ページ読み込み時に、URLパラメータから記事IDを取得し、新規作成か既存記事の編集かを判断します。既存記事の場合は、データベースから記事を取得してエディタにセットアップします。
+ 
+ ### 2. アクションボタンのイベントリスナー
+ 
+ ```javascript
+ // 保存ボタン
+ document.getElementById('save-article')?.addEventListener('click', async () => {
+     const saved = await KB.editor.api.saveArticle();
+ });
+ 
+ // プレビューボタン
+ document.getElementById('preview-article')?.addEventListener('click', () => {
+     KB.editor.api.previewArticle ? KB.editor.api.previewArticle() : KB.editor.previewArticle();
+ });
+ 
+ // エクスポートボタン
+ document.getElementById('export-article')?.addEventListener('click', () => {
+     KB.editor.updateArticleFromForm();
+     KB.editor.api.exportArticleToJson ? KB.editor.api.exportArticleToJson() : KB.io.exportArticle(KB.editor.article);
+ });
+ 
+ // キャンセルボタン
+ document.getElementById('cancel-editing')?.addEventListener('click', () => {
+     KB.editor.api.cancelEditor ? KB.editor.api.cancelEditor() : KB.editor.cancelEditor();
+ });
+ ```
+ 
+ 各アクションボタンにイベントリスナーを設定し、対応する処理を実行します。APIが提供されている場合はそれを使用し、ない場合は直接関数を呼び出します。
+ 
+ ### 3. ページ離脱時の確認
+ 
+ ```javascript
+ // 戻るボタンをオーバーライド
+ document.querySelector('a[href="index.html"]')?.addEventListener('click', (e) => {
+     if (KB.editor.hasUnsavedChanges()) {
+         if (!confirm('変更内容が保存されていません。このページを離れますか？')) {
+             e.preventDefault();
+         } else {
+             // 編集中のロックを解除
+             KB.editor.currentArticle && KB.articles.endEdit(KB.editor.currentArticle.id);
+         }
+     }
+ });
+ ```
+ 
+ 未保存の変更がある場合、ページを離れる前に確認ダイアログを表示します。キャンセルした場合はページ遷移を防止し、OKの場合は編集ロックを解除します。
+ 
+ ### 4. モーダルダイアログの制御
+ 
+ ```javascript
+ // モーダルクローズ処理
+ document.querySelectorAll('.modal-close').forEach(closeBtn => {
+     closeBtn.addEventListener('click', function() {
+         const modal = this.closest('.modal');
+         if (modal) modal.style.display = 'none';
+     });
+ });
+ 
+ // モーダル外クリックで閉じる
+ window.addEventListener('click', (e) => {
+     document.querySelectorAll('.modal').forEach(modal => {
+         if (e.target === modal) {
+             modal.style.display = 'none';
+         }
+     });
+ });
+ ```
+ 
+ モーダルダイアログの「×」ボタンやモーダル外のクリックで、モーダルを閉じる処理を実装しています。
+ 
+ ## エラーハンドリング
+ 
+ ページは以下のエラー状況に対応しています：
+ 
+ 1. **初期化エラー**：「エディタの初期化に失敗しました」というアラートを表示
+ 2. **記事取得エラー**：「記事が見つかりませんでした」というアラートを表示し、一覧ページにリダイレクト
+ 3. **編集エラー**：エラーメッセージをアラートで表示し、一覧ページにリダイレクト
+ 4. **一般的なエラー**：エラーメッセージをコンソールに出力
+ 
+ ## 依存関係
+ 
+ このページは以下のモジュールに依存しています：
+ 
+ 1. **schema.js** - データ構造の定義
+ 2. **database.js** - IndexedDBデータベース操作
+ 3. **converter.js** - 記事データをHTML形式に変換
+ 4. **jsonHelper.js** - JSON操作のヘルパー関数
+ 5. **sharedStatus.js** - 共有状態管理
+ 6. **storage.js** - JSONファイル同期
+ 7. **editor.js** - エディタのUI操作
+ 8. **api.js** - KB名前空間内のAPI関数
+ 
+ ## 使用例と拡張ポイント
+ 
+ ### 使用シナリオ
+ 
+ 1. 新規記事作成：トップページから「新規作成」ボタンをクリックし、`editor.html`ページを開く
+ 2. 既存記事編集：記事一覧または記事表示ページから「編集」ボタンをクリックし、`editor.html?id=123`のようなURLで遷移
+ 3. 記事情報とコンテンツブロックを編集
+ 4. プレビューでレイアウトを確認
+ 5. 保存またはエクスポート
+ 
+ ### 拡張の可能性
+ 
+ 1. **追加ブロックタイプ** - 表、引用、埋め込みコンテンツなど、新しいブロックタイプの追加
+ 2. **テンプレート機能** - よく使う記事構造をテンプレートとして保存・適用
+ 3. **画像アップロード** - 画像をアップロードして記事に挿入する機能
+ 4. **ドラッグ&ドロップ** - ブロックの順序をドラッグ&ドロップで変更
+ 5. **バージョン管理** - 記事の編集履歴を保存し、以前のバージョンに戻せるようにする 
```

---

<details>
            <summary>Searched codebase "index.htmlファイルの内容" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `Main/index.html` | L416-450 |
| `Main/index.html` | L1-29 |
| `Main/article.html` | L50-86 |
| `archive/old_files/rebuild/src/index.html` | L46-66 |
| `archive/old_files/rebuild/src/index.html` | L173-195 |
| `archive/old_files/backup/main copy 2.html` | L1-33 |
| `editor.html` | L1-49 |
| `archive/old_files/backup/main copy.html` | L1-33 |
| `article-template.html` | L1-24 |
| `archive/old_files/backup/main copy 3.html` | L1-33 |
| `archive/old_files/backup/main copy 4.html` | L1-33 |
| `archive/old_docs/article-list copy解読.html` | L1-16 |
| `archive/old_files/rebuild/src/index.html` | L1-46 |
| `archive/old_docs/MainBeta copy 3.html` | L1078-1183 |
| `archive/old_files/rebuild/src/index.html` | L266-286 |
| `archive/old_files/rebuild/src/index.html` | L97-130 |
| `archive/old_docs/article-list copy解読.html` | L1024-1046 |
| `archive/old_docs/article-list copymain.html` | L195-235 |
| `Main/test-converter.html` | L189-225 |
| `archive/old_files/backup/main copy 3.html` | L2832-2835 |
| `article-editor/index.html` | L1-25 |
| `archive/old_docs/MainBeta copy 2.html` | L1-33 |
| `archive/old_docs/article-list-modern.html` | L1-59 |
| `archive/old_docs/MainBeta copy 2.html` | L974-1074 |
| `archive/old_docs/MainBeta.html` | L1078-1183 |

</details>

---

Read file: Main/index.html

---

Read file: Main/index.html

---

```diff
- 
+ # 記事一覧ページ（index.html）
+ 
+ ## 概要
+ 
+ 記事一覧ページは、ナレッジベースシステムのメイン画面として、記事の一覧表示、検索、新規作成、インポート/エクスポート機能を提供します。このページからすべての主要機能にアクセスできるハブとして機能しています。
+ 
+ ## ファイル構造
+ 
+ `index.html`ファイルは、現在、以下のような構成で作られています：
+ 
+ - HTML基本構造（DOCTYPE宣言、head）
+ - 必要なJavaScriptモジュールの読み込み
+ - メインスクリプト（アプリケーション初期化、イベント処理、ユーティリティ関数）
+ - HTML本体要素のコメントによる構造説明
+ 
+ 注意：現在のファイルには `<body>` 要素が実装されておらず、コメント内に必要な要素が説明されています。これは開発途中のためと思われます。
+ 
+ ## 読み込まれるJavaScriptモジュール
+ 
+ ```html
+ <!-- コアモジュール（基本機能） -->
+ <script src="js/core/schema.js"></script>
+ <script src="js/core/database.js"></script>
+ <script src="js/core/search.js"></script>
+ <script src="js/core/indexer.js"></script>
+ <script src="js/core/converter.js"></script>
+ 
+ <!-- ユーティリティモジュール -->
+ <script src="js/util/debounce.js"></script>
+ <script src="js/util/jsonHelper.js"></script>
+ <script src="js/util/storage.js"></script>
+ <script src="js/util/sharedStatus.js"></script>
+ 
+ <!-- UIモジュール -->
+ <script src="js/ui/editor.js"></script>
+ 
+ <!-- APIモジュール（統合） -->
+ <script src="js/core/api.js"></script>
+ ```
+ 
+ ページは各種機能モジュールを読み込み、アプリケーションの初期化とユーザーインターフェース処理を行います。
+ 
+ ## メイン機能
+ 
+ ### 1. アプリケーション初期化
+ 
+ ```javascript
+ document.addEventListener('DOMContentLoaded', async () => {
+     // KBシステム初期化
+     const initialized = await KB.initialize();
+     
+     if (!initialized) {
+         console.warn('初期化が完了していません。一部機能が制限される可能性があります。');
+     }
+     
+     // 各種イベントリスナー設定と機能初期化
+     // ...
+     
+     // 記事一覧のロード
+     loadAllArticles();
+ });
+ ```
+ 
+ ページ読み込み時に`KB.initialize()`を呼び出してシステムを初期化し、各種イベントリスナーを設定します。最後に`loadAllArticles()`で記事一覧を表示します。
+ 
+ ### 2. 記事一覧表示
+ 
+ ```javascript
+ // すべての記事を読み込んで表示
+ async function loadAllArticles() {
+     const articles = await KB.articles.getAll();
+     displayArticleList(articles);
+ }
+ 
+ // 記事一覧を表示
+ function displayArticleList(articles) {
+     // 記事リストをDOMに追加
+     // ...
+     
+     articles.forEach(article => {
+         // 各記事項目のHTML生成
+         // ...
+         
+         // 表示、編集、削除ボタンの追加
+         // ...
+     });
+ }
+ ```
+ 
+ データベースから全記事を取得し、降順（最新順）に並べ替えて表示します。各記事には表示、編集、削除ボタンが付加されています。
+ 
+ ### 3. 記事表示機能
+ 
+ ```javascript
+ // 記事表示
+ async function viewArticle(id) {
+     try {
+         const article = await KB.articles.get(id);
+         
+         // HTML変換
+         let html = `<h1>${article.title || '(無題)'}</h1>`;
+         // メタデータ、タグ、コンテンツの表示処理
+         // ...
+         
+         // 表示切替
+         document.getElementById('editor-container').style.display = 'none';
+         view.style.display = 'block';
+         
+     } catch (error) {
+         console.error('記事表示エラー:', error);
+         alert('記事の表示に失敗しました');
+     }
+ }
+ ```
+ 
+ 選択された記事IDを元にデータベースから記事を取得し、HTMLに変換して表示します。記事の内容に応じてさまざまなHTML要素（見出し、段落、リスト、画像など）を生成します。
+ 
+ ### 4. 記事編集機能
+ 
+ ```javascript
+ // 記事編集
+ async function editArticle(id) {
+     try {
+         const article = await KB.articles.edit(id);
+         setupEditor(article, false);
+     } catch (error) {
+         console.error('記事編集エラー:', error);
+         alert(error.message || '記事の編集に失敗しました');
+     }
+ }
+ 
+ // エディタセットアップ
+ function setupEditor(article, isNew) {
+     currentArticle = article;
+     isNewArticle = isNew;
+     
+     // フォームに記事データを設定
+     // ...
+     
+     // 表示切替
+     document.getElementById('article-view').style.display = 'none';
+     document.getElementById('editor-container').style.display = 'block';
+ }
+ ```
+ 
+ 選択された記事を編集モードで開きます。`KB.articles.edit()`は記事データの取得とともに編集ロックも設定します。取得した記事データをエディタフォームに設定し、表示を切り替えます。
+ 
+ ### 5. 記事保存機能
+ 
+ ```javascript
+ // 現在の記事を保存
+ async function saveCurrentArticle() {
+     if (!currentArticle) return;
+     
+     // 値を取得
+     const title = document.getElementById('article-title').value.trim();
+     const content = document.getElementById('article-content').value;
+     
+     // バリデーション
+     if (!title) {
+         alert('タイトルを入力してください');
+         return;
+     }
+     
+     // 記事を更新
+     currentArticle.title = title;
+     currentArticle.content = content;
+     
+     try {
+         // 保存
+         await KB.articles.save(currentArticle, isNewArticle);
+         
+         // エディタをリセット
+         resetEditor();
+         
+         // 記事一覧を更新
+         loadAllArticles();
+         
+     } catch (error) {
+         console.error('保存エラー:', error);
+         alert('記事の保存に失敗しました');
+     }
+ }
+ ```
+ 
+ 編集中の記事をフォームから取得した値で更新し、データベースに保存します。保存後はエディタをリセットし、記事一覧を更新します。
+ 
+ ### 6. 記事削除機能
+ 
+ ```javascript
+ // 記事削除
+ async function deleteArticle(id) {
+     if (!confirm('記事を削除してもよろしいですか？')) return;
+     
+     try {
+         await KB.articles.delete(id);
+         
+         // 記事一覧を更新
+         loadAllArticles();
+         
+         // 表示をリセット
+         // ...
+         
+     } catch (error) {
+         console.error('記事削除エラー:', error);
+         alert(error.message || '記事の削除に失敗しました');
+     }
+ }
+ ```
+ 
+ 確認ダイアログ表示後、選択された記事をデータベースから削除します。削除後は記事一覧を更新し、表示をリセットします。
+ 
+ ### 7. 検索機能
+ 
+ ```javascript
+ // 検索
+ const searchInput = document.getElementById('search-input');
+ searchInput.addEventListener('input', debounce(async () => {
+     const query = searchInput.value.trim();
+     if (query.length > 0) {
+         const results = await KB.articles.searchFullText(query);
+         displayArticleList(results);
+     } else {
+         loadAllArticles();
+     }
+ }, 300));
+ ```
+ 
+ 検索ボックスに入力された値を使って全文検索を行い、結果を表示します。デバウンス処理により、入力から300ミリ秒後に実際の検索が実行されます。入力が空の場合は全記事を表示します。
+ 
+ ### 8. インポート/エクスポート機能
+ 
+ ```javascript
+ // インポートボタン
+ document.getElementById('import-button').addEventListener('click', async () => {
+     const fileInput = document.getElementById('import-file');
+     if (fileInput.files.length === 0) {
+         alert('ファイルを選択してください');
+         return;
+     }
+     
+     try {
+         const result = await KB.io.processJsonFiles(fileInput.files);
+         
+         // 結果表示と記事一覧更新
+         // ...
+     } catch (error) {
+         console.error('インポートエラー:', error);
+         document.getElementById('import-status').textContent = 'インポートに失敗しました';
+     }
+ });
+ 
+ // 全記事エクスポート
+ document.getElementById('export-all').addEventListener('click', async () => {
+     const articles = await KB.articles.getAll();
+     if (articles.length === 0) {
+         alert('エクスポートする記事がありません');
+         return;
+     }
+     
+     KB.io.exportArticles(articles);
+ });
+ ```
+ 
+ 選択されたJSONファイルから記事をインポート、またはすべての記事をJSONファイルとしてエクスポートする機能を提供します。インポート時は新規/更新/変更なしの記事数が表示されます。
+ 
+ ## 想定されるHTML構造
+ 
+ コメントから想定される`<body>`要素の構造は以下の通りです：
+ 
+ ```html
+ <body>
+     <!-- ヘッダー部分 -->
+     <header>...</header>
+     
+     <!-- 記事一覧 -->
+     <ul id="article-list">...</ul>
+     
+     <!-- 記事表示部分 -->
+     <div id="article-view">...</div>
+     
+     <!-- 編集フォーム -->
+     <div id="editor-container">
+         <input id="article-title" type="text">
+         <textarea id="article-content"></textarea>
+         <button id="save-article">保存</button>
+         <button id="cancel-editing">キャンセル</button>
+     </div>
+     
+     <!-- ユーザー名入力モーダル -->
+     <div id="username-modal">
+         <input id="username-input" type="text">
+         <button id="save-username">保存</button>
+     </div>
+     
+     <!-- インポート/エクスポートモーダル -->
+     <div id="import-export-modal">
+         <input id="import-file" type="file">
+         <button id="import-button">インポート</button>
+         <button id="export-all">全記事エクスポート</button>
+         <button id="close-modal">閉じる</button>
+         <div id="import-status"></div>
+     </div>
+     
+     <!-- 操作ボタン -->
+     <button id="new-article">新規作成</button>
+     <input id="search-input" type="text">
+     <button id="import-export">インポート/エクスポート</button>
+ </body>
+ ```
+ 
+ ## エラーハンドリング
+ 
+ ページは以下のエラー状況に対応しています：
+ 
+ 1. **初期化エラー**：コンソールに警告を表示し、一部機能が制限される可能性があることを通知
+ 2. **記事表示エラー**：エラーメッセージをアラートで表示
+ 3. **記事編集エラー**：エラーメッセージをアラートで表示
+ 4. **記事削除エラー**：エラーメッセージをアラートで表示
+ 5. **保存エラー**：エラーメッセージをアラートで表示
+ 6. **インポートエラー**：エラーメッセージを画面に表示
+ 
+ ## 依存関係
+ 
+ このページは以下のモジュールに依存しています：
+ 
+ 1. **schema.js** - データ構造の定義
+ 2. **database.js** - IndexedDBデータベース操作
+ 3. **search.js** - 検索機能
+ 4. **indexer.js** - 検索インデックス構築
+ 5. **converter.js** - 記事データをHTML形式に変換
+ 6. **debounce.js** - イベント最適化
+ 7. **jsonHelper.js** - JSON操作のヘルパー関数
+ 8. **storage.js** - JSONファイル同期
+ 9. **sharedStatus.js** - 共有状態管理
+ 10. **editor.js** - エディタのUI操作
+ 11. **api.js** - KB名前空間内のAPI関数
+ 
+ ## 使用例と拡張ポイント
+ 
+ ### 使用シナリオ
+ 
+ 1. ユーザーがページを開くと、保存されている記事の一覧が表示される
+ 2. ユーザー名が設定されていない場合は、ユーザー名入力モーダルが表示される
+ 3. 「新規作成」ボタンをクリックして新しい記事を作成できる
+ 4. 検索ボックスに入力して記事を検索できる
+ 5. 記事の「表示」「編集」「削除」ボタンで各操作を実行できる
+ 6. 「インポート/エクスポート」ボタンで記事のバックアップやリストアを行える
+ 
+ ### 拡張の可能性
+ 
+ 1. **記事リストの絞り込み** - タグやカテゴリによるフィルタリング機能
+ 2. **複数選択操作** - 複数記事の一括削除や一括エクスポート
+ 3. **ドラッグ&ドロップインポート** - ファイル選択ダイアログなしでの簡易インポート
+ 4. **リスト表示オプション** - リスト/グリッド表示の切り替えやソート順の変更
+ 5. **タグクラウド** - よく使われるタグの視覚的表示
+ 6. **進行中編集の復元** - ブラウザクラッシュからの編集内容の復元機能 
```

---

```diff
- 
+ # ナレッジベースシステム 概要
+ 
+ ## はじめに
+ 
+ ナレッジベースシステムは、記事の作成、編集、検索、保存を行うためのオフライン対応Webアプリケーションです。ユーザーは様々なコンテンツブロックを使って記事を構築し、IndexedDBに保存することができます。また、JSONファイルとしてエクスポート/インポートすることで、バックアップや他のデバイスとの同期が可能です。
+ 
+ ## システム構成
+ 
+ システムは以下の主要コンポーネントで構成されています：
+ 
+ ### 1. HTMLページ
+ 
+ - **index.html** - 記事一覧ページ（メインページ）
+ - **article.html** - 記事表示ページ
+ - **editor.html** - 記事編集ページ
+ 
+ ### 2. JavaScriptモジュール
+ 
+ #### コアモジュール
+ - **schema.js** - データ構造の定義
+ - **database.js** - IndexedDBデータベース操作
+ - **converter.js** - 記事データとHTML間の変換
+ - **api.js** - 統合API（各モジュールへのインターフェース）
+ 
+ #### 検索関連
+ - **search.js** - 検索機能
+ - **indexer.js** - 検索インデックス構築
+ 
+ #### ユーティリティ
+ - **jsonHelper.js** - JSON操作のヘルパー関数
+ - **storage.js** - JSONファイル同期
+ - **sharedStatus.js** - 共有ステータス管理
+ - **debounce.js** - イベント最適化
+ 
+ #### UIモジュール
+ - **editor.js** - エディタのUI操作
+ 
+ ### 3. データフロー
+ 
+ ![データフロー図](../img/data-flow.png)
+ 
+ 1. ユーザーがUI経由でデータを操作
+ 2. API層がリクエストを適切なモジュールに転送
+ 3. データ操作はデータベース層で処理
+ 4. 変更はUIに反映、必要に応じてストレージに永続化
+ 
+ ## 主要機能
+ 
+ ### 1. 記事管理
+ 
+ - 新規記事の作成
+ - 既存記事の表示と編集
+ - 記事の削除
+ - 記事の検索（タイトル・全文）
+ 
+ ### 2. ブロックベースエディタ
+ 
+ 記事は以下のようなブロックで構成されます：
+ 
+ - 見出し (Heading)
+ - 段落 (Paragraph)
+ - リスト (List) - 順序付き/順序なし
+ - 画像 (Image)
+ - コード (Code)
+ 
+ ブロックベースのエディタにより、コンテンツの構造化と柔軟な編集が可能です。
+ 
+ ### 3. 検索機能
+ 
+ - タイトル検索
+ - 全文検索
+ - リアルタイム検索結果表示（デバウンス処理）
+ 
+ ### 4. データの永続化
+ 
+ - IndexedDBによるブラウザ内ストレージ
+ - JSONファイルのエクスポート/インポート
+ - 編集中のロック機能による同時編集防止
+ 
+ ## 技術スタック
+ 
+ - **フロントエンド**: 純粋なJavaScript (バニラJS)
+ - **データ保存**: IndexedDB (ブラウザ内ストレージ)
+ - **UI**: HTML5, CSS3
+ - **エディタ**: カスタムブロックエディタ
+ 
+ ## システムの拡張性
+ 
+ システムは以下の方針で拡張可能に設計されています：
+ 
+ 1. **モジュール化** - 各機能は独立したモジュールとして実装
+ 2. **APIレイヤー** - 統一されたAPIによる内部モジュールの抽象化
+ 3. **プラグイン構造** - 新機能を既存コードを変更せずに追加可能
+ 4. **イベントベース通信** - モジュール間の疎結合な通信
+ 
+ ## 使用方法
+ 
+ ### 記事の作成
+ 
+ 1. トップページ（index.html）の「新規作成」ボタンをクリック
+ 2. タイトル、カテゴリ、タグを入力
+ 3. 「ブロックを追加」ボタンでコンテンツブロックを追加
+ 4. ブロックの編集ボタンでコンテンツを編集
+ 5. 「保存」ボタンで記事を保存
+ 
+ ### 記事の編集
+ 
+ 1. 記事一覧または記事表示ページから「編集」ボタンをクリック
+ 2. 記事データが編集フォームに読み込まれる
+ 3. コンテンツを編集
+ 4. 「保存」ボタンで変更を保存
+ 
+ ### 記事のエクスポート/インポート
+ 
+ 1. トップページの「インポート/エクスポート」ボタンをクリック
+ 2. 「全記事エクスポート」で全記事をJSONファイルとして保存
+ 3. 「ファイルを選択」でJSONファイルを選択し、「インポート」で記事をインポート
+ 
+ ## 制限事項
+ 
+ - オフライン専用のアプリケーションであり、オンライン同期機能はない
+ - 画像はBase64エンコードで保存されるため、大量の画像の使用はパフォーマンスに影響する可能性がある
+ - 大量の記事や大きな記事はブラウザのストレージ制限に達する可能性がある
+ 
+ ## 将来の拡張計画
+ 
+ - サーバー側との同期機能
+ - 複数デバイス間のリアルタイム編集
+ - タグベースのナビゲーション強化
+ - 高度な全文検索機能
+ - テンプレート機能
+ - マークダウンインポート/エクスポート 
```

---

<details>
            <summary>Listed directory Main/doc • **13** results</summary>
        
| Name |
|-------|
| 📄 `project_overview.md` |
| 📄 `editor.js_documentation.md` |
| 📄 `database.js_documentation.md` |
| 📄 `converter.js_documentation.md` |
| 📄 `storage.js_documentation.md` |
| 📄 `search.js_documentation.md` |
| 📄 `sharedStatus.js_documentation.md` |
| 📄 `schema.js_documentation.md` |
| 📄 `jsonHelper.js_documentation.md` |
| 📄 `indexer.js_documentation.md` |
| 📄 `debounce.js_documentation.md` |
| 📄 `api.js_documentation.md` |
| 📄 `README.md` |

</details>

---

```diff
  
  ## ドキュメント一覧
+ 
+ ### システム概要
+ 
+ - [プロジェクト概要](project_overview.md) - システム全体の構造と機能
+ 
+ ### HTMLページ
+ 
+ - [記事一覧ページ](index_page_documentation.md) - メインページ（index.html）
+ - [記事表示ページ](article_page_documentation.md) - 個別記事表示（article.html）
+ - [記事編集ページ](editor_page_documentation.md) - 記事作成・編集（editor.html）
  
  ### コアモジュール
  - **データ保存**: IndexedDB (ブラウザ内ストレージ)
  - **UI**: HTML5, CSS3
- - **エディタ**: カスタムRTFエディタ
+ - **エディタ**: カスタムブロックエディタ
  
  ## アーキテクチャ概要
```

---

ナレッジベースシステムの各モジュールのドキュメントが完成しました。すべてのファイルがMain/docディレクトリに正しく保存されています。

ドキュメントの構成：

1. **プロジェクト概要** - システム全体の構造と機能の概要
2. **各HTMLページのドキュメント**
   - 記事一覧ページ（index.html）
   - 記事表示ページ（article.html）
   - 記事編集ページ（editor.html）
3. **各JavaScriptモジュールのドキュメント**
   - コアモジュール（schema.js, database.js, api.js など）
   - 検索関連（indexer.js, search.js）
   - コンテンツ処理（converter.js, editor.js）
   - ユーティリティ（storage.js, sharedStatus.js, jsonHelper.js, debounce.js）

これらのドキュメントには各モジュールの詳細な説明、使用例、コードサンプル、依存関係、拡張方法などが含まれています。READMEファイルも更新され、新しいドキュメントへのリンクが追加されました。

今後、新しいモジュールが追加された場合や既存モジュールが変更された場合は、対応するドキュメントも更新する必要があります。

---



---

